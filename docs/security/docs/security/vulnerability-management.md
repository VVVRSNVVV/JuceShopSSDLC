# Vulnerability Management — JuiceShopSSDLC

## 1. Purpose

This document describes how security vulnerabilities in the JuiceShopSSDLC project are:
- discovered,
- triaged,
- prioritized,
- fixed,
- and verified.

Goal: ensure that no known **Critical** or **High** vulnerability is ignored or left unfixed without explicit risk acceptance.

---

## 2. Sources of Vulnerabilities

Vulnerabilities may come from:

- SAST tools (Semgrep, CodeQL)
- DAST (OWASP ZAP)
- Secret scanning (Gitleaks, GitHub secret scan)
- Dependency scanning (npm audit, Dependabot)
- Manual code reviews
- External reports (e.g. via GitHub Issues)

Each finding must be recorded and tracked via a **GitHub Issue**.

---

## 3. Severity Levels

We use a simplified severity model (inspired by CVSS):

| Severity  | Description                                           |
|----------|--------------------------------------------------------|
| Critical | Remote code execution, auth bypass, DB dump, key leak  |
| High     | SQLi, XSS, IDOR, path traversal, broken auth           |
| Medium   | Sensitive information disclosure, weak crypto, misconfig |
| Low      | Best practices, missing security headers, minor issues |

Severity is assigned considering:
- impact on **A1–A6 assets** (see Security Requirements),
- exploitability (need for auth, complexity),
- availability of existing mitigations.

---

## 4. SLA for Fixing Vulnerabilities

| Severity  | Time to triage | Time to fix / mitigate           |
|----------|----------------|-----------------------------------|
| Critical | 24 hours        | 7 days (preferably immediately)  |
| High     | 3 days          | 14 days                          |
| Medium   | 7 days          | 30 days                          |
| Low      | 14 days         | Best effort / next planned refactor |

If vulnerability cannot be fixed within SLA, it must have an explicit **Risk Acceptance** note in the corresponding issue.

---

## 5. Workflow

1. **Discovery**  
   - Tool or person reports a finding.  
   - A GitHub Issue is created with label `security` and appropriate severity.

2. **Triage**  
   - Confirm that the finding is real (not a false positive).  
   - Identify affected components, endpoints, and data.  
   - Assign severity and label: `severity:critical|high|medium|low`.

3. **Planning**  
   - Assign the issue to an owner.  
   - Add it to a milestone (e.g. `security-hardening`, `release-1.0`).  

4. **Remediation**  
   - Implement a fix in a dedicated branch.  
   - Add tests (unit/integration/security regression).

5. **Verification**  
   - Reviewer verifies code and tests.  
   - Relevant scanners are re-run (e.g. Semgrep rule becomes “green”).  

6. **Closure**  
   - Issue is closed only after:
     - fix is merged into `main`, and  
     - verification step is successful.  

7. **Post-mortem (for Critical)**  
   - For Critical vulns, a short post-mortem is added as a comment:
     - root cause  
     - how it slipped through  
     - what process improvement is introduced.

---

## 6. Labels & Conventions (GitHub)

We use the following labels:

- `security`
- `severity:critical`
- `severity:high`
- `severity:medium`
- `severity:low`
- `type:dependency`
- `type:code`
- `type:configuration`

Example issue title:

> `[SEC][CRITICAL] SQL Injection in /login route`

---

## 7. False Positives & Won’t Fix

If a finding is a false positive or intentionally left vulnerable (for educational reasons), the issue must include:

- clear justification,
- reference to documentation (e.g. “this route is kept vulnerable to demonstrate OWASP Top 10”),
- label `security:wont-fix`.

---

## 8. Tool Configuration

- SAST (Semgrep/CodeQL) should use configs stored in the repository (`semgrep.yml`, `.github/codeql/*`).  
- Tools must be run automatically in CI on every push/PR to `main`.

---
